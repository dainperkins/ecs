---
- name: threat
  title: Threat
  group: 2
  short: Fields describing detected threats and threat intel data
  description: >
    ECS threat fields encompass detected suspicious activity (e.g. IDS alert, malware activity) typically
    reported by IDS/IPS and NGFWs, as well as threat intel/global IOC data ingested from a feed source like MISP or Anomali. 
    Tactic and technique fields can be populated from information provided by the reporting system, or can be evaluated 
    based on internal framework preferences at ingest time, or retrospectively.

  type: group
  fields:

    - name: id
      level: extended
      type: keyword
      short: Reported threat ID.
      description: >
        Threat ID, typically provided by reporting system (e.g. NGFW or IDS) or threat intel provider (Anomali, OTX, etc.)

      example: 33227 

    - name: name
      level: extended
      type: keyword
      multi_field:
        type: text
        name: text
      short: Reported threat name.
      description: >
        Threat name, typically provided by reporting system (e.g. NGFW or IDS signature) or threat intel provider (Anomali, OTX, etc.)

      example: ntp reserved mode denial of service

    - name: category
      level: extended
      type: keyword
      multi_field:
        type: text
        name: text
      short: Reported threat category.
      description: >
        Threat category, typically provided by reporting system (e.g. NGFW or IDS signature) or threat intel provider (Anomali, OTX, etc.)

      example: Denial of Service

    - name: revision
      format: string
      level: extended
      type: long
      short: Reported threat revision
      description: >
        Threat revision is a numerical value provided by the observer or threat intel provider identifying the specific version
        of the signature used for detection, or the specific revision of the threat intel record.

      example: 1.1 

    - name: severity
      level: extended
      type: keyword
      short: Reported threat severity.
      description: >
        Typically a qualitative description of the risk associated with the observed threat or IOC. The reported 
        severity and confidence fields can be normalized to provide a threat.risk.score for the overall event.

      example: low, medium, high, critical, 1-5, 1-10, etc.

    - name: confidence
      level: extended
      type: keyword
      short: Threat confidence.
      description: >
        Typically a qualitative description of the observing systems confidence in the correct identification of a 
        threeat (more prevalent in AI/ ML analysis), user provided confidence in the observing systems detection capabilities, 
        or confidence in a particular threat intel provider. The severity and confidence fields can be normalized to
        calculate a value for threat.risk.score for the overall event at ingest time or retrospectively.

      example: low, medium, high, 1-5, 1-10, etc

    - name: framework
      level: extended
      type: keyword
      short: Threat classification framework.
      description: >
        Name of the threat framework used to further categorize and classify the tactic and technique of the reported threat.  
        Framework classification can be provided by detecting systems, evaluated at ingest time, or retrospectively tagged to events.

      example: MITRE ATT&CK 

    - name: tactic.name
      level: extended
      type: keyword
      multi_field:
        type: text
        name: text
      short: Threat tactic.
      description: >
          Name of the type of tactic used by this threat. You can use the Mitre ATT&CK Matrix Tactic categorization, for example.
          (ex. https://attack.mitre.org/tactics/TA0040/ )

      example: impact

    - name: tactic.id
      level: extended
      type: keyword
      short: Threat tactic id.
      description: >
          The id of tactic used by this threat. You can use the Mitre ATT&CK Matrix Tactic categorization, for example.
          (ex. https://attack.mitre.org/tactics/TA0040/ )

      example: TA0040

    - name: tactic.reference
      level: extended
      type: keyword
      short: Therat tactic url reference.
      description: >
          The reference url of tactic used by this threat. You can use the Mitre ATT&CK Matrix Tactic categorization, for example.
          (ex. https://attack.mitre.org/tactics/TA0040/ )

      example: https://attack.mitre.org/tactics/TA0040/

    - name: technique.name
      level: extended
      type: keyword
      multi_field:
        type: text
        name: text
      short: Threat technique name.
      description: >
          The name of technique used by this tactic. You can use the Mitre ATT&CK Matrix Tactic categorization, for example.
          (ex. https://attack.mitre.org/techniques/T1499/ )

      example: endpoint denial of service

    - name: technique.id
      level: extended
      type: keyword
      multi_field:
        type: text
        name: text
      short: Threat technique id.
      description: >
          The id of technique used by this tactic. You can use the Mitre ATT&CK Matrix Tactic categorization, for example.
          (ex. https://attack.mitre.org/techniques/T1499/ )

      example: T1499

    - name: technique.reference
      level: extended
      type: keyword
      short: Threat technique reference.
      description: >
          The reference url of technique used by this tactic. You can use the Mitre ATT&CK Matrix Tactic categorization, for example.
          (ex. https://attack.mitre.org/techniques/T1499/ )

      example: https://attack.mitre.org/techniques/T1499/
