---
- name: vlan
  title: VLAN
  group: 2
  short: Fields to describe VLAN information and configuration.
  description: >
    The VLAN fields describe information about the configuration of VLANs in an enterprise network, as well as 
    the relevant 802.1q tagging information observed in network traffic.    

    VLAN fields contain configuration information about virtiual LANs, with base identification
    fields (id, name, inner, outer and related fields) reusable under source, destination, and 
    interface fields when observers or hosts are providing relevant information in events (e.g. 
    netflow, firewall logs, host and network logs, etc.)  The full set of VLAN fields provides 
    a place for detailed configuration information regarding VLANs in the environment.  
    
    Because VLANs configuration is locally significant,  VLAN configuration fields should be used in conjunction
    with host or observer fields to ensure configurations are attributable to the appropriate source device(s).

  reusable:
    top_level: true
    expected:
      - source
      - destination
#      - interface
 
  type: group
  fields:

    - name: id
      level: core
      type: integer
      short: 802.1q VLAN ID
      example: 10
      description: >
        VLAN ID of the configured VLAN. Expected values are 0 to 4095, with 0 and 4095 typically being 
        reserved for system use, and not reported.

    - name: name 
      level: core
      type: keyword
      example: "Routing Backbone"
      description: >
        VLAN name as configured on the device, or reported in the event.

    - name: said
      level: extended
      type: keyword
      short: Security Association ID
      example: 100010
      description: >
        VLAN SAID is a user configurable security association identifier that may be configured to allow
        various network security platforms to properly identify traffic by VLAN.

    - name: mtu
      level: extended
      type: keyword
      example: 1500
      description: >
        Maximum transmission unit is the maximum size of packets processed in this VLAN.  
        This value will typically be in the range of 68 - 9216, with 1400-1500 and 9216 being
        the most likely.

    - name: state 
      level: extended
      type: keyword
      short: Current VLAN state
      example: "active"
      description: >
        Current state of the VLAN as reported by the source device.

    - name: mode
      level: extended
      type: keyword
      short: Non-standard VLAN operating modes
      example: "private"
      description: >
        the vlan.mode field is used to identify any non-standard or vendor specific VLAN modes as configured. For example, 
        Cisco VLANs can be configured to operate in "private" or "rspan" VLAN modes.  Standard VLAN modes can leave 
        this field blank.

    - name: vlan.inner.id
      level: extended
      type: keyword
      short: Inner VLAN ID for q-in-q traffic
      example: 10
      description: >
        The vlan.inner.id field is used to record the innermost vlan (initial 802.1q encapsulation) in cases where
        multiple 802.1q encapsulations have been performed.  This field can be nested under source, destination, and 
        network fields.

    - name: vlan.inner.name
      level: extended
      type: keyword
      short: Inner VLAN name for q-in-q traffic
      example: "Client_A_VLAN"
      description: >
        The vlan.inner.name field is used to record the name of the innermost vlan (initial 802.1q encapsulation) 
        in cases where multiple 802.1q encapsulations have been performed.  This field can be nested under source, 
        destination, and network fields.

    - name: vlan.outer.id
      level: extended
      type: keyword
      short: Outer VLAN ID for q-in-q traffic
      example: 20
      description: >
        The vlan.outer.id field is used to record the id of the outermost vlan (final 802.1q encapsulation) in cases where
        multiple 802.1q encapsulations have been performed. This field can be nested under source, destination, and 
        network fields.

    - name: vlan.outer.name
      level: extended
      type: keyword
      short: Outer VLAN name for q-in-q traffic
      example: "Core_Transit"
      description: >
        The vlan.outer.name field is used to record the outermost VLAN name (final 802.1q encapsulation) in cases where
        multiple 802.1q encapsulations have been performed.  This field can be nested under source, destination, and 
        network fields.

    - name: vlan.related.id
      level: extended
      type: keyword
      short: Array of additional VLAN IDs in q-in-q traffic
      example: [12,14,16]
      description: >
        The vlan.related.id field is used to record any intermediate VLAN IDs in cases where more than 2 q-in-q
        encapsulations are present. This field can be nested under source, destination, and network fields.

    - name: vlan.related.name
      level: extended
      type: keyword
      short: Array of additional VLAN names in q-in-q traffic
      example: ["transit1", "transit2", "transit3"]
      description: >
        The vlan.related.id field is used to record any intermediate VLAN IDs in cases where more than 2 q-in-q
        encapsulations are present. This field can be nested under source, destination, and network fields.